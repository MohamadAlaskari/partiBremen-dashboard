<app-toast></app-toast>

<a routerLink="/user-management">
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left"
    viewBox="0 0 16 16">
    <path fill-rule="evenodd"
      d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8" />
  </svg>
</a>


<app-section-header [title]="title" time=""></app-section-header>

<form *ngIf="userForm" class="row g-3" [formGroup]="userForm" (ngSubmit)="onSubmit()">
  @if (userForm.invalid && userFormSubmitted) {
  <div class="alert alert-danger">
    Please correct the errors in the form before submitting.
  </div>
  }
  <!--Name-->
  <div class="col-md-6">
    <div class="form-floating">
      <input type="text" class="form-control " id="name" placeholder="" formControlName="name" [required]="true"
        [class.is-invalid]="userForm.get('name')!.invalid && userForm.get('name')!.touched"
        [class.is-valid]="userForm.get('name')!.valid && userForm.get('name')!.touched">
      <label for="name" class="form-label">Name*</label>
      @if(userForm.get('name')!.invalid && userForm.get('name')!.touched || userFormSubmitted){
      <div class="invalid-feedback">
        Please provide a valid name.
      </div>
      }
    </div>
  </div>

  <!--Surname-->
  <div class="col-md-6">
    <div class="form-floating">
      <input type="text" class="form-control"
        [class.is-invalid]="userForm.get('surname')!.invalid && userForm.get('surname')!.touched"
        [class.is-valid]="userForm.get('surname')!.valid && userForm.get('surname')!.touched" id="surname"
        placeholder="" formControlName="surname">
      <label for="surname" class="form-label">Surname*</label>
      @if(userForm.get('surname')!.invalid && userForm.get('surname')!.touched){
      <div class="invalid-feedback">
        Please provide a valid surname.
      </div>
      }
    </div>
  </div>
  <!--Role-->
  <div class="col-md-4">
    <div class="form-floating">
      <select class="form-select" id="role" formControlName="role"
        [class.is-invalid]="userForm.get('role')!.invalid && userForm.get('role')!.touched  || userFormSubmitted"
        [class.is-valid]="userForm.get('role')!.valid && userForm.get('role')!.touched  || userFormSubmitted">
        <option value="0">Default</option>
        <option value="1">User</option>
        <option value="2">Creator</option>
        <option value="3">Moderator</option>
        <option value="4">Admin</option>
        <option value="5">Decider</option>
      </select>
      <label for="role">Role*</label>
      @if (userForm.get('role')!.invalid && userForm.get('role')!.touched || userFormSubmitted) {
      <div class="invalid-feedback">
        Please select a role.
      </div>
      }
    </div>
  </div>

  <!--Date of Birth-->
  <div class="col-md-8">
    <div class="form-floating">
      <input type="date" class="form-control" id="dob" placeholder="" formControlName="dob"
        [class.is-invalid]="userForm.get('dob')!.invalid && userForm.get('dob')!.touched"
        [class.is-valid]="userForm.get('dob')!.valid && userForm.get('dob')!.touched">
      <label for="dob" class="form-label">Date of Birth*</label>
      @if(userForm.get('dob')!.invalid && userForm.get('dob')!.touched || userFormSubmitted){
      <div class="invalid-feedback">
        Please provide a valid date of birth.
      </div>
      }
    </div>
  </div>

  <!--Email-->
  <div class="col-md-6">
    <div class="form-floating">
      <input type="email" class="form-control" id="email" placeholder="" formControlName="email"
        [class.is-invalid]="userForm.get('email')!.invalid && userForm.get('email')!.touched  || userFormSubmitted"
        [class.is-valid]="userForm.get('email')!.valid && userForm.get('email')!.touched  || userFormSubmitted">
      <label for="email" class="form-label">Email*</label>
      @if ((userForm.get('email')!.invalid && userForm.get('email')!.touched) || userFormSubmitted) {
      <div class="invalid-feedback">
        Please provide a valid email.
      </div>
      }
    </div>
  </div>

  <!--Password-->
  <div class="col-md-6">
    <div class="form-floating">
      <input type="password" class="form-control" id="password" placeholder="" formControlName="password"
        [class.is-invalid]="userForm.get('password')!.invalid && userForm.get('password')!.touched  || userFormSubmitted"
        [class.is-valid]="userForm.get('password')!.valid && userForm.get('password')!.touched  || userFormSubmitted">
      <label for="password" class="form-label">Password*</label>
      @if ((userForm.get('password')!.invalid && userForm.get('password')!.touched) || userFormSubmitted) {
      <div class="invalid-feedback">
        Please provide a valid password.
      </div>
      }
    </div>
  </div>

  <div class="d-grid gap-4 d-md-block">

    <button type="reset" role="button" (click)="onCancel()" class="btn btn-outline-dark">close</button>
    <button type="submit" role="button" (click)="onSubmit()" class="btn btn-dark mx-md-3">
      updat user</button>
  </div>

</form>
